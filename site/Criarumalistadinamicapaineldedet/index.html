<!DOCTYPE html>
<html lang="en">
	<head>
		
		
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		
		
		
		<link rel="shortcut icon" href="../img/favicon.ico">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
		<title>Criar uma lista dinâmica + painel de detalhes - Firecast Documentation</title>
		<link href="../bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
		<link href="../css/font-awesome-5.12.2-all.min.css" rel="stylesheet">
		<link href="../css/base.css" rel="stylesheet">
		<link rel="stylesheet" href="../css/highlight-github.css">
		<script src="../bootstrap/dist/js/bootstrap.min.js"></script>
		<script src="../js/highlight.pack.js"></script>
		
		<script>
			var base_url = '..';
			var home_url = '../home';
			var is_outer_page = false;
			
			var pageToc = [
				{title: "Criar uma lista din\u00e2mica + painel de detalhes", url: "#_top", children: [
				]},
				{title: "Criar uma lista din\u00e2mica + painel de detalhes", url: "#criar-uma-lista-dinamica-painel-de-detalhes_1", children: [
						
				{title: "Dois arquivos Lua Form (extens\u00e3o \".LFM\")", url: "#_top", children: [
				]},
				{title: "Imagens", url: "#imagens", children: [
				]},
				{title: "Sobre a implementa\u00e7\u00e3o", url: "#sobre-a-implementacao", children: [
				]},
				{title: "C\u00f3digo Fonte", url: "#codigo-fonte", children: [
				]},
				]},
				{title: "Lista Din\u00e2mica + Painel de Detalhes alternativo", url: "#lista-dinamica-painel-de-detalhes-alternativo", children: [
						
				{title: "C\u00f3digo Fonte Alternativo", url: "#_top", children: [
				]},
				]},
				{title: "Incrementando o c\u00f3digo: Selecionar o primeiro item ao carregar os dados", url: "#incrementando-o-codigo-selecionar-o-primeiro-item-ao-carregar-os-dados", children: [
				]},
			];

		</script>
		<script src="../js/base.js"></script> 
	</head>

	<body class="inner-page">
		

		<div class="container-fluid wm-page-content">
			<a name="_top" aria-hidden="true"></a>
			






<div class="row pt-2 pb-4">
	<div class="col-sm text-center text-sm-left">
		<a href="../Fazerumafichaenviarrolagensparaa/" class="btn btn-sm btn-outline-dark">
			<i class="fa fa-chevron-left" aria-hidden="true"></i>
			Previous
		</a>
		<a href="../Fazerumafichaenviarrolagensparaa/" class="btn btn-sm btn-link">
			Fazer uma ficha enviar rolagens para a mesa
		</a>
	</div>
	

	
	<div class="col-sm text-center text-sm-right">
		<a href="../Criarumbotaoqueescondeitensdeuma/" class="btn btn-sm btn-link">
			Criar um botão que esconde itens de uma lista dinâmica
		</a>
		<a href="../Criarumbotaoqueescondeitensdeuma/" class="btn btn-sm btn-outline-dark">
			Next
			<i class="fa fa-chevron-right" aria-hidden="true"></i>
		</a>
	</div>
	
</div>

			

			<h1 id="criar-uma-lista-dinamica-painel-de-detalhes">Criar uma lista dinâmica + painel de detalhes</h1>
<h1 id="criar-uma-lista-dinamica-painel-de-detalhes_1">Criar uma lista dinâmica + painel de detalhes</h1>
<p>&nbsp;</p>
<p>Este tutorial vai ensinar a criar uma lista dinâmica de itens que, quando você selecionar um dos itens desta lista, exibe um painel detalhando as informações sobre o item selecionado.</p>
<p>É recomendado você ler <a href="../Criarumalistadinamicanaficha/">Criar uma lista dinâmica na ficha</a> antes, pois este tutorial utiliza a mesma ideia.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2 id="dois-arquivos-lua-form-extensao-lfm">Dois arquivos Lua Form (extensão ".LFM")</h2>
<p>Utilizaremos a <a href="../TagrecordList/">tag recordList</a> neste tutorial, portanto, você deve possuir dois arquivos ".lfm":</p>
<ul>
<li>&nbsp;</li>
<li>O arquivo Lua Form principal que contém a tag recordList</li>
<li>O arquivo Lua Form Template dos Itens do Record List: Este form vai ser <a href="../LuaFormeInstancias/">instanciado</a> 1 vez para cada item na lista.</li>
</ul>
<p>&nbsp;</p>
<p>Neste tutorial, chamaremos o arquivo Lua Form Principal de "MinhaFicha.lfm" e o arquivo Lua Form Template dos Itens de "ItemDaLista.lfm"</p>
<p>&nbsp;</p>
<h2 id="imagens">Imagens</h2>
<p>&nbsp;</p>
<p><img alt="Image" src="../lib/NewItem197.png" />\
\
<img alt="Image" src="../lib/NewItem198.png" />\
\
<img alt="Image" src="../lib/NewItem199.png" />\
&nbsp;</p>
<h2 id="sobre-a-implementacao">Sobre a implementação</h2>
<p>A ideia para criar esta lista dinâmica com painel de detalhes é bem simples. Existem dois componentes chaves nesta ideia:</p>
<ul>
<li>&nbsp;</li>
<li>Você precisa de um <a href="../TagrecordList/">recordList</a> que funcionará como uma lista onde o usuário possa escolher o item.</li>
<li>Você precisará de um <a href="../TagdataScopeBox/">dataScopeBox</a> que conterá as tags que são apresentadas no painel de detalhes.</li>
</ul>
<p>&nbsp;</p>
<p>Quando o usuário escolher um item no recordList (evento <a href="../TagrecordList/#Evento%20onSelect">"onSelect" da tag recordList</a>), fazemos com que os componentes que estão dentro do dataScopeBox passem a salvar/carregar dados neste item ao alterar o escopo de dados das tags que estão dentro. Caso tenha dúvida sobre escopo de dados, veja <a href="../LuaFormeNodeDatabase/#Escopo%20de%20dados">Escopo de Dados no Lua Form</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><img alt="Image" src="../lib/NewItem202.png" /></p>
<p>&nbsp;</p>
<p><img alt="Image" src="../lib/NewItem203.png" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2 id="codigo-fonte">Código Fonte</h2>
<p>&nbsp;</p>
<table>
<thead>
<tr>
<th><strong>Arquivo “MinhaFicha.lfm”</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>\&lt;?xml</strong> version="1.0" encoding="UTF-8"<strong>?&gt;</strong> <strong>\&lt;form</strong> name="frmFTeste" theme="dark" padding="{left=4, top=4, right=4, bottom=4}"<strong>&gt;</strong>                <em>\&lt;!-- Botão de inserir novo item à lista --&gt;</em>         <strong>\&lt;layout</strong> align="top" height="30" margins="{bottom=4}"<strong>&gt;</strong>                 <strong>\&lt;button</strong> text="Criar Novo Item" width="150" align="left"<strong>&gt;</strong>                         <strong>\&lt;event</strong> name="onClick"<strong>&gt;</strong>                                 <em>-- Usuário clicou no botão de criar novo item.</em>                                 <em>-- Vamos inserir um novo item no nosso recordList                              *                                 self.rclListaDosItens:append();                         </em><em>\&lt;/event&gt;</em><em>                 </em><em>\&lt;/button&gt;</em><em>         </em><em>\&lt;/layout&gt;</em><em>                </em>\&lt;!-- recordList, representando a lista --&gt;<em>         </em><em>\&lt;recordList</em><em> name="rclListaDosItens" field="campoDosItens" templateForm="frmItemDaLista"                                 align="client" selectable="true"</em><em>&gt;</em><em>                                               </em><em>\&lt;event</em><em> name="onSelect"</em><em>&gt;</em><em>                         --[[                         </em>Este evento é chamado quando o usuário selecionar/deselecionar itens da lista. Quando o usuário selecionar, vamos fazer nosso dataScopeBox (e todas as tag dentro dele) salvar e carregar dados no &nbsp; objeto Nodo (NodeDatabase) do item selecionado.<em>                   --]]                                         </em><em>local</em><em> node = self.rclListaDosItens.selectedNode; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; self.boxDetalhesDoItem.node = node;                                          </em>-- a caixa de detalhe só ficará visível se houver item selecionado<em>                         &nbsp; self.boxDetalhesDoItem.visible = (node ~= nil);                 </em><em>\&lt;/event&gt;</em><em>         </em><em>\&lt;/recordList&gt;</em><em>                </em>\&lt;!-- dataScopeBox representando a nossa caixa de detalhes --&gt;<em>           </em><em>\&lt;dataScopeBox</em><em> name="boxDetalhesDoItem" visible="false" align="right"  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; width="400" margins="{left=4, right=4}"</em><em>&gt;</em><em>                 </em>\&lt;!-- Faça um layout "bonito" para sua caixa de detalhes =). Utilize a propriedade "field" nas tags aqui dentro &nbsp; --&gt;<em>                        </em><em>\&lt;rectangle</em><em> align="top" color="black" xradius="10" yradius="10"                                    height="180" padding="{top=3, left=3, right=3, bottom=3}"</em><em>&gt;</em><em>                                                             </em><em>\&lt;layout</em><em> align="top" height="30" margins="{bottom=4}"</em><em>&gt;</em><em>                                 </em><em>\&lt;label</em><em> align="left" text="Titulo do Item:" autoSize="true"</em><em>/&gt;</em><em>                                 </em><em>\&lt;edit</em><em> align="client" field="campoTitulo"</em><em>/&gt;</em><em>                         </em><em>\&lt;/layout&gt;</em><em>                                                </em><em>\&lt;layout</em><em> align="top" height="130"</em><em>&gt;</em><em>                                               </em><em>\&lt;image</em><em> align="left" editable="true" field="campoURLImagem" width="130"</em><em>/&gt;</em><em>                                                                </em><em>\&lt;layout</em><em> align="client" margins="{left=2}"</em><em>&gt;</em><em>                                         </em><em>\&lt;edit</em><em> align="top" field="campoSubTitulo" height="30"</em><em>/&gt;</em><em>                                         </em><em>\&lt;textEditor</em><em> align="top" field="campoTextoGrande" height="100"</em><em>/&gt;</em><em>                                 </em><em>\&lt;/layout&gt;</em><em>                                               </em><em>\&lt;/layout&gt;</em><em>                 </em><em>\&lt;/rectangle&gt;</em><em>         </em><em>\&lt;/dataScopeBox&gt;</em><em> </em><em>\&lt;/form&gt;</em>*</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<table>
<thead>
<tr>
<th><strong>Arquivo “ItemDaLista.lfm”</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>\&lt;?xml</strong> version="1.0" encoding="UTF-8"<strong>?&gt;</strong> <strong>\&lt;form</strong> name="frmItemDaLista" height="50" theme="dark"<strong>&gt;</strong>          <strong>\&lt;layout</strong> align="client" margins="{left=4, right=4, top=4, bottom=4}"<strong>&gt;</strong>                 <em>\&lt;!-- Botão para apagar o item da lista --&gt;</em>                 <strong>\&lt;button</strong> align="left" width="32" text="X" onClick="ndb.deleteNode(sheet);"<strong>/&gt;</strong>                                <em>\&lt;!-- O título do item que aparece na lista --&gt;</em>                 <strong>\&lt;label</strong> align="client" text="Teste de label" field="campoTitulo" margins="{left=4}"<strong>/&gt;</strong>         <strong>\&lt;/layout&gt;</strong> <strong>\&lt;/form&gt;</strong></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1 id="lista-dinamica-painel-de-detalhes-alternativo">Lista Dinâmica + Painel de Detalhes alternativo</h1>
<p>&nbsp;</p>
<p><img alt="Image" src="../lib/NewItem200.png" /><img alt="Image" src="../lib/NewItem201.png" /></p>
<p>&nbsp;</p>
<h2 id="codigo-fonte-alternativo">Código Fonte Alternativo</h2>
<p>&nbsp;</p>
<table>
<thead>
<tr>
<th><strong>Arquivo “MinhaFicha.lfm”</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>\&lt;?xml</strong> version="1.0" encoding="UTF-8"<strong>?&gt;</strong> <strong>\&lt;form</strong> name="frmFTeste" theme="dark" padding="{left=4, top=4, right=4, bottom=4}"<strong>&gt;</strong> &nbsp;       <em>\&lt;!-- Botão de inserir novo item à lista --&gt;</em>         <strong>\&lt;layout</strong> align="top" height="30" margins="{bottom=4}"<strong>&gt;</strong>                 <strong>\&lt;button</strong> text="Criar Novo Item" width="150" align="left"<strong>&gt;</strong>                         <strong>\&lt;event</strong> name="onClick"<strong>&gt;</strong>                                 <em>-- Usuário clicou no botão de criar novo item.</em>                                 <em>-- Vamos inserir um novo item no nosso recordList                              *                                 self.rclListaDosItens:append();                         </em><em>\&lt;/event&gt;</em><em>                 </em><em>\&lt;/button&gt;</em><em>         </em><em>\&lt;/layout&gt;</em><em>                </em>\&lt;!-- recordList, representando a lista --&gt;<em>         </em><em>\&lt;recordList</em><em> name="rclListaDosItens" field="campoDosItens" templateForm="frmItemDaLista" align="top" selectable="true" layout="horizontal" height="40"</em><em>&gt;</em><em>                                        </em><em>\&lt;event</em><em> name="onSelect"</em><em>&gt;</em><em>                         --[[                         </em>Este evento é chamado quando o usuário selecionar/deselecionar itens da lista. Quando o usuário selecionar, vamos fazer nosso dataScopeBox (e todas as tag dentro dele) salvar e carregar dados no &nbsp; objeto Nodo (NodeDatabase) do item selecionado.<em>                   --]]                                         </em><em>local</em><em> node = self.rclListaDosItens.selectedNode; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; self.boxDetalhesDoItem.node = node;                                          </em>-- a caixa de detalhe só ficará visível se houver item selecionado<em>                         &nbsp; self.boxDetalhesDoItem.visible = (node ~= nil); &nbsp;               </em><em>\&lt;/event&gt;</em><em>         </em><em>\&lt;/recordList&gt;</em><em>                              </em>\&lt;!-- dataScopeBox representando a nossa caixa de detalhes --&gt;<em>           </em><em>\&lt;dataScopeBox</em><em> name="boxDetalhesDoItem" visible="false" align="client"                    &nbsp;  margins="{left=4, right=4, top=2}"</em><em>&gt;</em><em>                 </em>\&lt;!-- Faça um layout "bonito" para sua caixa de detalhes =). Utilize a propriedade "field" nas tags aqui dentro   --&gt;<em>                       </em><em>\&lt;rectangle</em><em> align="client" color="black" xradius="10" yradius="10"                            padding="{top=3, left=3, right=3, bottom=3}"</em><em>&gt;</em><em>                                                             </em><em>\&lt;layout</em><em> align="top" height="30" margins="{bottom=4}"</em><em>&gt;</em><em>                                 </em><em>\&lt;label</em><em> align="left" text="Titulo do Item:" autoSize="true"</em><em>/&gt;</em><em>                                 </em><em>\&lt;edit</em><em> align="client" field="campoTitulo"</em><em>/&gt;</em><em>                                                                                                </em>\&lt;!-- Botão de apagar o item --&gt;<em>                                </em><em>\&lt;button</em><em> align="right" text="Apagar!" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; margins="{left=4, right=4, top=2, bottom=2}" width="150"                                        onClick="ndb.deleteNode(self.boxDetalhesDoItem.node);" </em><em>/&gt;</em><em>                         </em><em>\&lt;/layout&gt;</em><em>                                                </em><em>\&lt;layout</em><em> align="top" height="130"</em><em>&gt;</em><em>                                               </em><em>\&lt;image</em><em> align="left" editable="true" field="campoURLImagem" width="130"</em><em>/&gt;</em><em>                                                                </em><em>\&lt;layout</em><em> align="client" margins="{left=2}"</em><em>&gt;</em><em>                                         </em><em>\&lt;edit</em><em> align="top" field="campoSubTitulo" height="30"</em><em>/&gt;</em><em>                                         </em><em>\&lt;textEditor</em><em> align="top" field="campoTextoGrande" height="100"</em><em>/&gt;</em><em>                                 </em><em>\&lt;/layout&gt;</em><em>                                               </em><em>\&lt;/layout&gt;</em><em>                 </em><em>\&lt;/rectangle&gt;</em><em>         </em><em>\&lt;/dataScopeBox&gt;</em><em> </em><em>\&lt;/form&gt;</em>*</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<table>
<thead>
<tr>
<th><strong>Arquivo “ItemDaLista.lfm”</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>\&lt;?xml</strong> version="1.0" encoding="UTF-8"<strong>?&gt;</strong> <strong>\&lt;form</strong> name="frmItemDaLista" height="50" width="100"<strong>&gt;</strong>         <em>\&lt;!-- O título do item que aparece na lista --&gt;</em>         <strong>\&lt;label</strong> align="client" text="Teste de label" field="campoTitulo" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; margins="{left=4, right=4, top=4, bottom=4}"<strong>/&gt;</strong>       &nbsp;         <em>\&lt;!-- Adicionar um valor padrão para o campoTitulo caso esteja vazio.</em>                 <em>Isto é especialmente útil em novos itens --&gt;</em>         <strong>\&lt;dataLink</strong> field="campoTitulo" defaultValue="Titulo Aqui"<strong>/&gt;</strong> <strong>\&lt;/form&gt;</strong></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1 id="incrementando-o-codigo-selecionar-o-primeiro-item-ao-carregar-os-dados">Incrementando o código: Selecionar o primeiro item ao carregar os dados</h1>
<p>&nbsp;</p>
<p>Trate o evento "<a href="../TagrecordList/#Evento%20onEndEnumeration">onEndEnumeration</a>" da tag recordList com o seguinte código:</p>
<p>&nbsp;</p>
<table>
<thead>
<tr>
<th><strong>\&lt;event</strong> name="onEndEnumeration"<strong>&gt;</strong>         <strong>if</strong> self.rclListaDosItens.selectedNode == nil <strong>and</strong> sheet ~= nil <strong>then</strong>                 <strong>local</strong> nodes = ndb.getChildNodes(sheet.campoDosItens);                                <strong>if</strong> #nodes &gt; 0 <strong>then</strong>                         self.rclListaDosItens.selectedNode = nodes[1];                 <strong>end</strong>;         <strong>end</strong>; <strong>\&lt;/event&gt;</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Veja <a href="../TratandoeventosdoLuaForm/">Tratando eventos do Lua Form</a>.</p>
<hr />
<p><em>Created with the Personal Edition of HelpNDoc: <a href="https://www.helpndoc.com/feature-tour/markdown-import-export-using-helpndoc-help-authoring-tool/">Powerful and User-Friendly Help Authoring Tool for Markdown Documents</a></em></p>

			<br>
			






<div class="row pt-2 pb-4">
	<div class="col-sm text-center text-sm-left">
		<a href="../Fazerumafichaenviarrolagensparaa/" class="btn btn-sm btn-outline-dark">
			<i class="fa fa-chevron-left" aria-hidden="true"></i>
			Previous
		</a>
		<a href="../Fazerumafichaenviarrolagensparaa/" class="btn btn-sm btn-link">
			Fazer uma ficha enviar rolagens para a mesa
		</a>
	</div>
	

	
	<div class="col-sm text-center text-sm-right">
		<a href="../Criarumbotaoqueescondeitensdeuma/" class="btn btn-sm btn-link">
			Criar um botão que esconde itens de uma lista dinâmica
		</a>
		<a href="../Criarumbotaoqueescondeitensdeuma/" class="btn btn-sm btn-outline-dark">
			Next
			<i class="fa fa-chevron-right" aria-hidden="true"></i>
		</a>
	</div>
	
</div>

			<br>
		</div>

		<footer class="container-fluid wm-page-content text-center small">
			<p>
			<a href="https://github.com/Krampus-update/firecast-doc-test/edit/master/docs/Criarumalistadinamicapaineldedet.md" target="_blank"><i class="fab fa-github"></i>
Edit on GitHub</a>
			</p>
			<details>
				<summary>
					Documentation built with <a href="http://www.mkdocs.org/" target="_blank">MkDocs</a> using  <a href="https://github.com/Siphalor/mkdocs-custommill" target="_blank">CustomMill</a>.
				</summary>
				<h6 class="mt-2">Additional Licenses</h6>
				<ul><li>
						CustomMill is based on the <a href="https://github.com/gristlabs/mkdocs-windmill" target="_blank">Windmill</a> theme by Grist Labs, licensed under the <a href="https://github.com/gristlabs/mkdocs-windmill/blob/master/LICENSE" target="_blank">MIT License</a>
					</li>
					<li>
						CustomMill includes <a href="https://getbootstrap.com" target="_blank">Bootstrap</a> version 5.1.3. This is available under the <a href="https://github.com/twbs/bootstrap/blob/master/LICENSE" target="_blank">MIT License</a>.
					</li>
					<li>
						Syntax highlighting is implemented via <a href="https://highlightjs.org" target="_blank">highlight.js</a> licensed under the BSD 3-Clause License and the included github styling made by Vasily Polovnyov.
					</li>
					<li>
						Icons on this site are from <a href="https://fontawesome.com/" target="_blank">Font Awesome</a> which is licensed under the <a href="https://fontawesome.com/license/free" target="_blank">Font Awesome Free License</a>.
					</li></ul>
				<p>Built at 2023-08-31 02:21:40 UTC</p>
			</details>
		</footer>

		
	</body>
</html>