<!DOCTYPE html>
<html lang="en">
	<head>
		
		
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		
		
		
		<link rel="shortcut icon" href="../img/favicon.ico">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
		<title>Objeto HTTPRequest - Firecast Documentation</title>
		<link href="../bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
		<link href="../css/font-awesome-5.12.2-all.min.css" rel="stylesheet">
		<link href="../css/base.css" rel="stylesheet">
		<link rel="stylesheet" href="../css/highlight-github.css">
		<script src="../bootstrap/dist/js/bootstrap.min.js"></script>
		<script src="../js/highlight.pack.js"></script>
		
		<script>
			var base_url = '..';
			var home_url = '../home';
			var is_outer_page = false;
			
			var pageToc = [
				{title: "Objeto HTTPRequest", url: "#_top", children: [
				]},
				{title: "Objeto HTTPRequest", url: "#objeto-httprequest_1", children: [
						
				{title: "Restri\u00e7\u00f5es:", url: "#_top", children: [
				]},
				{title: "Caracter\u00edsticas", url: "#caracteristicas", children: [
				]},
				{title: "Exemplos", url: "#exemplos", children: [
				]},
				]},
			];

		</script>
		<script src="../js/base.js"></script> 
	</head>

	<body class="inner-page">
		

		<div class="container-fluid wm-page-content">
			<a name="_top" aria-hidden="true"></a>
			






<div class="row pt-2 pb-4">
	<div class="col-sm text-center text-sm-left">
		<a href="../BibliotecaLocale/" class="btn btn-sm btn-outline-dark">
			<i class="fa fa-chevron-left" aria-hidden="true"></i>
			Previous
		</a>
		<a href="../BibliotecaLocale/" class="btn btn-sm btn-link">
			Biblioteca Locale
		</a>
	</div>
	

	
	<div class="col-sm text-center text-sm-right">
		<a href="../ObjetoNodo/" class="btn btn-sm btn-link">
			Objeto Nodo
		</a>
		<a href="../ObjetoNodo/" class="btn btn-sm btn-outline-dark">
			Next
			<i class="fa fa-chevron-right" aria-hidden="true"></i>
		</a>
	</div>
	
</div>

			

			<h1 id="objeto-httprequest">Objeto HTTPRequest</h1>
<h1 id="objeto-httprequest_1">Objeto HTTPRequest</h1>
<p>O Objeto HTTPRequest é utilizado para a troca de dados com um servidor usando protocolo HTTP ou HTTPS.</p>
<p>É excelente para integrar o plug-in com alguma api REST, baixar ou enviar informações para um servidor da World Wide Web.</p>
<p>&nbsp;</p>
<p>Para instanciar um Objeto HTTPRequest, utilize a função <a href="../BibliotecaInternet/#newHTTPRequest">internet.newHTTPRequest</a></p>
<h3 id="restricoes">Restrições:</h3>
<ul>
<li>&nbsp;</li>
<li>As requisições HTTP são permitidas apenas se o usuário do rrpg for um membro GOLD.</li>
</ul>
<p>&nbsp;</p>
<h2 id="caracteristicas">Características</h2>
<h3 id="propriedades-e-atributos">Propriedades e atributos</h3>
<table>
<thead>
<tr>
<th><strong>Propriedade</strong></th>
<th>Tipo</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>url</strong></td>
<td>String</td>
<td>Define a URL para onde a requisição HTTP será direcionada.&nbsp; Exemplo:&nbsp; "http://www.google.com/xx/document.txt" "https://www.rrpg.com.br/apiexemplo"&nbsp; A URL deve iniciar com "http://" ou "https://"&nbsp;</td>
</tr>
<tr>
<td><strong>method</strong></td>
<td>String</td>
<td>Define o método/verbo HTTP que será utilizado na requisição.&nbsp; Os possíveis valores são: "GET" (padrão) "POST" "PUT" "PATCH" "TRACE" "HEAD" "OPTIONS" "DELETE"&nbsp;</td>
</tr>
<tr>
<td><strong>status</strong></td>
<td>Integer</td>
<td>Um número contendo o status da resposta http. (Exemplos: 200 para ok, 404 para não encontrado, etc..)&nbsp; Consulte <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html">http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html</a> para saber quais são os possíveis status.&nbsp;</td>
</tr>
<tr>
<td><strong>statusText</strong></td>
<td>String</td>
<td>Uma cadeia de caracteres contendo o texto-status-resposta da requisição HTTP.&nbsp; Diferente da propriedade "status", este valor contém o texto completo da resposta (Exemplos: "200 OK", "404 NOT FOUND").&nbsp;</td>
</tr>
<tr>
<td><strong>responseText</strong></td>
<td>String</td>
<td>Contém o corpo da resposta interpretada como texto.&nbsp; O "charset" do cabeçalho de resposta "Content-Type" é levado em consideração antes de retornar o texto.&nbsp;</td>
</tr>
<tr>
<td><strong>responseStream</strong></td>
<td><a href="../ObjetoStream/">Objeto Stream</a></td>
<td>Contém o corpo da resposta em um <a href="../ObjetoStream/">objeto stream</a>. Muito útil quando a resposta dada pelo servidor for binária.&nbsp;</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3 id="metodos">Métodos</h3>
<table>
<thead>
<tr>
<th><strong>Método</strong></th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>request:send([content])</strong></td>
<td>Inicia o envio da requisição HTTP. Antes de chamar esta função, a URL e todos os cabeçalhos devem ser informados pela função <a href="./#setRequestHeader">setRequestHeader</a>.&nbsp; Parâmetros: (OPCIONAL) content - Uma cadeia de caracteres ou um <a href="../ObjetoStream/">objeto stream</a> contendo os dados que serão enviado ao servidor. Se não informado, a requisição é feita com corpo vazio.&nbsp; Observações: A requisição é assíncrona. Isto é, a função send retorna imediatamente e o código LUA continua sua execução normal enquanto a comunicação com o servidor é feita em segundo plano. Para obter a resposta, manipule os eventos onResponse e onError antes de chamar este método. Se o parâmetro content for uma cadeia de caracteres, o&nbsp; "charset" do cabeçalho de requisição "Content-Type" é levado em consideração para a codificação do texto.&nbsp;</td>
</tr>
<tr>
<td><strong>request:setRequestHeader(header, value)</strong></td>
<td>Altera o valor de um cabeçalho de requisição HTTP. Você deve enviar setRequestHeader antes de invocar o método <a href="./#send">send</a>.&nbsp; Parâmetros: header - Cadeia de caracteres representando o nome do cabeçalho. Exemplos: "Content-Type" , "Content-Encoding", etc.. value - Cadeia de caracteres com o valor que deve ser associado ao cabeçalho.&nbsp; Observações: Para saber mais sobre os cabeçalhos HTTP, veja <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html">http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html</a>. Se este método for chamado várias vezes alterando o mesmo cabeçalho, o valor da última chamada prevalecerá.&nbsp;</td>
</tr>
<tr>
<td><strong>request:getRequestHeader(header)</strong></td>
<td>Obtém o valor de um cabeçalho de requisição HTTP.&nbsp; Parâmetros: header - cadeia de caracteres representando o nome do cabeçalho. Retorno: Uma cadeia de caracteres, contendo o valor do cabeçalho.&nbsp;</td>
</tr>
<tr>
<td><strong>request:getResponseHeader(header)</strong></td>
<td>Obtém o valor de um cabeçalho de resposta da requisição HTTP.&nbsp; Parâmetros: header - cadeia de caracteres representando o nome do cabeçalho de resposta. Retorno: Uma cadeia de caracteres, contendo o valor do cabeçalho, ou "" (cadeia de caracteres vazia) se o cabeçalho não existir na resposta. Para saber mais sobre os cabeçalhos HTTP, veja <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html">http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html</a>.&nbsp;</td>
</tr>
<tr>
<td><strong>request:getAllResponseHeaders()</strong></td>
<td>Retorna uma cadeia de caracteres contendo todos os cabeçalhos da resposta HTTP de uma só vez.&nbsp;</td>
</tr>
<tr>
<td><strong>request:abort();</strong></td>
<td>Aborta a requisição HTTP que está sendo feita.&nbsp;</td>
</tr>
<tr>
<td><strong>request:open(method, url);</strong></td>
<td>Inicializa a requisição HTTP&nbsp; Parâmetros: method - Uma cadeia de caracteres identificando o método/verbo HTTP utilizado nesta requisição. Os valores aceitos são: "GET"&nbsp; "POST" "PUT" "PATCH" "TRACE" "HEAD" "OPTIONS" "DELETE" url - A URL da requisição HTTP&nbsp; Observação: O uso deste método não é obrigatório. É apenas um "doce" para aqueles que estão acostumados com a requisição HTTP do JavaScript.&nbsp;</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3 id="eventos">Eventos</h3>
<table>
<thead>
<tr>
<th><strong>Nome do evento</strong></th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>onResponse</strong></td>
<td>Este evento é invocado quando a requisição HTTP concluir sem erros. Após este evento, as propriedades de resposta estarão disponíveis no objeto (como, por exemplo, status, statusText, responseText, etc..).&nbsp; Observação: Se o servidor retornar status 4xx&nbsp; (algum erro de requisição) ou 5xx (algum erro do servidor), o evento "onError" será disparado ao invés de "onResponse"&nbsp;</td>
</tr>
<tr>
<td><strong>onError</strong></td>
<td>Este evento é disparado quando ocorrer um erro na requisição HTTP.&nbsp; Parâmetros: errorMsg - Uma cadeia de caracteres contendo informações sobre o erro.&nbsp; Observação: Se o servidor retornar status 4xx&nbsp; (algum erro de requisição) ou 5xx (algum erro do servidor), o evento "onError" será disparado ao invés de "onResponse"&nbsp;</td>
</tr>
<tr>
<td><strong>onReceiveProgress</strong></td>
<td>Evento que é disparado frequentemente a fim de informar o progresso de download da requisição HTTP.&nbsp; Parâmetros: currentBytes - Um número indicando quantos bytes já foram baixados maxBytes - Um número indicando quantos bytes serão baixados no final das contas.&nbsp;</td>
</tr>
<tr>
<td><strong>onSendProgress</strong></td>
<td>Evento que é disparado frequentemente a fim de informar o progresso de upload da requisição HTTP.&nbsp; Parâmetros: currentBytes - Um número indicando quantos bytes já foram enviados. maxBytes - Um número indicando quantos bytes serão enviados no final das contas.&nbsp;</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h2 id="exemplos">Exemplos</h2>
<h3 id="exemplo-1-baixar-o-indexhtml-de-um-site">Exemplo 1 - Baixar o "index.html" de um site.</h3>
<p>&nbsp;</p>
<table>
<thead>
<tr>
<th>require("internet.lua");  <strong>local</strong> requisicao = internet.newHTTPRequest("GET", "http://www.rrpg.com.br/");  requisicao.onResponse =         <strong>function</strong>()                 showMessage("Conteúdo: " .. requisicao.responseText);         <strong>end</strong>;  requisicao.onError =         <strong>function</strong>(errorMsg)                 showMessage("Ops! Ocorreu algum erro: " .. errorMsg);         <strong>end</strong>;     requisicao:send();</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3 id="exemplo-2-fazer-um-upload-de-um-arquivo-receber-outro-arquivo-rastreando-o-progresso">Exemplo 2 - Fazer um upload de um arquivo, receber outro arquivo, rastreando o progresso.</h3>
<p>&nbsp;</p>
<table>
<thead>
<tr>
<th>require("internet.lua");  require("vhd.lua"); &nbsp; <strong>local</strong> requisicao = internet.newHTTPRequest("POST", "http://www.rrpg.com.br/REST_API/URL");  requisicao.onResponse =         <strong>function</strong>()                 <strong>local</strong> streamResposta = requisicao.responseStream;                       <strong>local</strong> tipoRetornado = requisicao:getResponseHeader("Content-Type");                     <strong>local</strong> arquivoDestino;                                        <strong>if</strong> tipoRetornado == "image/png" <strong>then</strong>                         arquivoDestino = vhd.openFile("/baixado.png", "w+");                 <strong>else</strong>                         arquivoDestino = vhd.openFile("/baixado.outraExtensao", "w+");                 <strong>end</strong>;                                arquivoDestino:copyFrom(streamResposta, streamResposta.size);                 arquivoDestino:close();         <strong>end</strong>; requisicao.onError =         <strong>function</strong>(errorMsg)                 showMessage("Ops! Ocorreu algum erro: " .. errorMsg);         <strong>end</strong>;           requisicao.onSendProgress =                 <strong>function</strong>(currentBytes, maxBytes)                         <strong>local</strong> porcentagem;                                                <strong>if</strong> maxBytes ~= 0 <strong>then</strong>                                 porcentagem = (currentBytes / maxBytes) * 100;                         <strong>else</strong>                                 porcentagem = 0;                         <strong>end</strong>;                                                <em>--- porcentagem contém quantos % do arquivo já foram enviados</em>                 <strong>end</strong>;                requisicao.onReceiveProgress =                 <strong>function</strong>(currentBytes, maxBytes)                         <strong>local</strong> porcentagem;                                                <strong>if</strong> maxBytes ~= 0 <strong>then</strong>                                 porcentagem = (currentBytes / maxBytes) * 100;                         <strong>else</strong>                                 porcentagem = 0;                         <strong>end</strong>;                                                <em>--- porcentagem contém quantos % do arquivo já foi recebido.</em>                 <strong>end</strong>;            <strong>local</strong> arquivoAEnviar = vhd.openFile("/arquivoExistente.png", "r");           requisicao:setRequestHeader("Content-Type", "image/png");       requisicao:send(arquivoAEnviar);</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<hr />
<p><em>Created with the Personal Edition of HelpNDoc: <a href="https://www.helpndoc.com/feature-tour/stunning-user-interface/">Revolutionize Your Documentation Output with HelpNDoc's Stunning User Interface</a></em></p>

			<br>
			






<div class="row pt-2 pb-4">
	<div class="col-sm text-center text-sm-left">
		<a href="../BibliotecaLocale/" class="btn btn-sm btn-outline-dark">
			<i class="fa fa-chevron-left" aria-hidden="true"></i>
			Previous
		</a>
		<a href="../BibliotecaLocale/" class="btn btn-sm btn-link">
			Biblioteca Locale
		</a>
	</div>
	

	
	<div class="col-sm text-center text-sm-right">
		<a href="../ObjetoNodo/" class="btn btn-sm btn-link">
			Objeto Nodo
		</a>
		<a href="../ObjetoNodo/" class="btn btn-sm btn-outline-dark">
			Next
			<i class="fa fa-chevron-right" aria-hidden="true"></i>
		</a>
	</div>
	
</div>

			<br>
		</div>

		<footer class="container-fluid wm-page-content text-center small">
			<p>
			<a href="https://github.com/Krampus-update/firecast-doc-test/edit/master/docs/ObjetoHTTPRequest.md" target="_blank"><i class="fab fa-github"></i>
Edit on GitHub</a>
			</p>
			<details>
				<summary>
					Documentation built with <a href="http://www.mkdocs.org/" target="_blank">MkDocs</a> using  <a href="https://github.com/Siphalor/mkdocs-custommill" target="_blank">CustomMill</a>.
				</summary>
				<h6 class="mt-2">Additional Licenses</h6>
				<ul><li>
						CustomMill is based on the <a href="https://github.com/gristlabs/mkdocs-windmill" target="_blank">Windmill</a> theme by Grist Labs, licensed under the <a href="https://github.com/gristlabs/mkdocs-windmill/blob/master/LICENSE" target="_blank">MIT License</a>
					</li>
					<li>
						CustomMill includes <a href="https://getbootstrap.com" target="_blank">Bootstrap</a> version 5.1.3. This is available under the <a href="https://github.com/twbs/bootstrap/blob/master/LICENSE" target="_blank">MIT License</a>.
					</li>
					<li>
						Syntax highlighting is implemented via <a href="https://highlightjs.org" target="_blank">highlight.js</a> licensed under the BSD 3-Clause License and the included github styling made by Vasily Polovnyov.
					</li>
					<li>
						Icons on this site are from <a href="https://fontawesome.com/" target="_blank">Font Awesome</a> which is licensed under the <a href="https://fontawesome.com/license/free" target="_blank">Font Awesome Free License</a>.
					</li></ul>
				<p>Built at 2023-08-31 02:21:41 UTC</p>
			</details>
		</footer>

		
	</body>
</html>